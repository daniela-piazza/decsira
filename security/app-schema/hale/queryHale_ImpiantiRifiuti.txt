SELECT "decsira"."decsira_t_azienda"."id_imp_azienda","decsira"."decsira_t_azienda"."codice_sira",
"decsira"."decsira_t_azienda"."id_istanza","decsira"."decsira_t_azienda"."denominazione",
"decsira"."decsira_t_azienda"."codice_fiscale","decsira"."decsira_t_azienda"."partita_iva",
"decsira"."decsira_t_azienda"."indirizzo","decsira"."decsira_t_azienda"."cod_istat",
"decsira"."decsira_t_azienda"."fk_l2","decsira"."decsira_t_azienda"."toponimo",
"decsira"."decsira_t_azienda"."istat_provincia",
"decsira"."decsira_t_azienda"."des_provincia","decsira"."decsira_t_azienda"."telefono",
"decsira"."decsira_t_azienda"."fax","decsira"."decsira_t_azienda"."cognome_titolare",
"decsira"."decsira_t_azienda"."nome_titolare","decsira"."decsira_t_azienda"."numero_ciaa",
"decsira"."decsira_t_azienda"."anno_ciaa","decsira"."decsira_geo_impianto_rifiuti_aua_noaua"."id_rifiuto_generico" 
FOREIGN_ID_0_0 FROM "decsira"."decsira_t_azienda" INNER JOIN "decsira"."decsira_geo_impianto_rifiuti_aua_noaua" 
ON ( "decsira_geo_impianto_rifiuti_aua_noaua"."codice_sira" = "decsira_t_azienda"."codice_sira")  
INNER JOIN (SELECT DISTINCT "decsira"."decsira_geo_impianto_rifiuti_aua_noaua"."id_rifiuto_generico"
 FROM "decsira"."decsira_geo_impianto_rifiuti_aua_noaua"
  ORDER BY "decsira"."decsira_geo_impianto_rifiuti_aua_noaua"."id_rifiuto_generico" ASC LIMIT 50)
   "decsira_geo_impianto_1"
    ON ("decsira_geo_impianto_rifiuti_aua_noaua"."id_rifiuto_generico" = "decsira_geo_impianto_1"."id_rifiuto_generico" )  
    ORDER BY "decsira"."decsira_geo_impianto_rifiuti_aua_noaua"."id_rifiuto_generico" 
    ASC, "decsira"."decsira_t_azienda"."id_imp_azienda" ASC,  
    CASE WHEN "decsira"."decsira_geo_impianto_rifiuti_aua_noaua"."codice_sira" = "decsira"."decsira_t_azienda"."codice_sira"
     THEN 0 ELSE 1 END ASC